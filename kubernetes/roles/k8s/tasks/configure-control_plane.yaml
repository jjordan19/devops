- name: Add Firewalld Rule
  shell: firewall-cmd --permanent --add-port=6443/tcp --add-port=2379-2380/tcp --add-port=10250/tcp --add-port=10251/tcp --add-port=10252/tcp

- name: Reload Firewalld
  shell: firewall-cmd --reload

- name: Check if kubelet.conf exists
  stat:
    path: "/etc/kubernetes/kubelet.conf"
  register: kubelet_conf

- include: init_cluster.yaml
  when: kubeadm_conf.stat.exists == False
  
- name: Restart kubelet
  service:
    name: kubelet
    state: restarted
